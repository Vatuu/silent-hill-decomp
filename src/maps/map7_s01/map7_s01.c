#include "bodyprog/bodyprog.h"
#include "bodyprog/math/math.h"
#include "bodyprog/item_screens.h"
#include "main/rng.h"
#include "maps/shared.h"
#include "maps/map7/map7_s01.h"

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800C9578);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", g_MapOverlayHeader);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800CC9A4);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800CD010);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800CDE18);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CA5C8);

#include "maps/shared/sharedFunc_800D08B8_0_s00.h" // 0x800CDF80

#include "maps/shared/sharedFunc_800D0A60_0_s00.h" // 0x800CE100

#include "maps/shared/sharedFunc_800D0B18_0_s00.h" // 0x800CE1B8

#include "maps/shared/sharedFunc_800D0E04_0_s00.h" // 0x800CE31C

#include "maps/shared/sharedFunc_800CFFD8_0_s01.h" // 0x800CE33C

#include "maps/shared/sharedFunc_800D0850_0_s01.h" // 0x800CEBB4

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800CEFA0);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D03B8);

#include "maps/shared/sharedFunc_800D209C_0_s00.h" // 0x800D0808

#include "maps/shared/sharedFunc_800D20D8_0_s00.h" // 0x800D0844

#include "maps/shared/sharedFunc_800D20E4_0_s00.h" // 0x800D0850

#include "maps/shared/sharedFunc_800D2244_0_s00.h" // 0x800D09B0

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D0B88);

#include "maps/shared/sharedFunc_800D2C7C_0_s00.h" // 0x800D1418

#include "maps/shared/sharedFunc_800D2D2C_0_s00.h" // 0x800D14C8

#include "maps/shared/sharedFunc_800D2D44_0_s00.h" // 0x800D14E0

#include "maps/shared/sharedFunc_800D2D6C_0_s00.h" // 0x800D1508

#include "maps/shared/sharedFunc_800D2D84_0_s00.h" // 0x800D1520

#include "maps/shared/sharedFunc_800D2DAC_0_s00.h" // 0x800D1548

#include "maps/shared/sharedFunc_800D2E50_0_s00.h" // 0x800D15EC

#include "maps/shared/sharedFunc_800D2E60_0_s00.h" // 0x800D15FC

void func_800D1608(void) {}

void func_800D1610(void) {}

void func_800D1618(void) {}

void func_800D1620(void) {}

void func_800D1628(void) {}

s32 func_800D1630() // 0x800D1630
{
    return 0;
}

void func_800D1638(void) {}

#include "maps/shared/sharedFunc_800D2EA4_0_s00.h" // 0x800D1640

#include "maps/shared/sharedFunc_800D2EB4_0_s00.h" // 0x800D1650

#include "maps/shared/sharedFunc_800D2EF4_0_s00.h" // 0x800D1690

#include "maps/shared/sharedFunc_800CD6B0_3_s03.h" // 0x800D16A4

#include "maps/shared/sharedFunc_800CD7F8_3_s03.h" // 0x800D17EC

#include "maps/shared/sharedFunc_800CD920_3_s03.h" // 0x800D1914

#include "maps/shared/sharedFunc_800CD940_3_s03.h" // 0x800D1934

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D1974);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D19E8);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D1A38);

#include "maps/shared/sharedFunc_800CDA88_3_s03.h" // 0x800D1A7C

#include "maps/shared/Ai_PuppetNurse_UpdateMain.h" // 0x800D1AAC

#include "maps/shared/Ai_PuppetNurse_Init.h" // 0x800D1B50

#include "maps/shared/Ai_PuppetNurse_Update.h" // 0x800D1D24

#include "maps/shared/Ai_PuppetDoctor_Update.h" // 0x800D1D80

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D1DDC);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CDF24_3_s03); // 0x800D1F18

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D20D8);

bool func_800D238C(s32 arg0) // 0x800D238C
{
    return arg0 == 36 || arg0 == 34 || arg0 == 37 || arg0 == 35;
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CE3CC_3_s03); // 0x800D23C0

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CE500_3_s03); // 0x800D24F4

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CE5E4_3_s03); // 0x800D25D8

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D27BC);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CEA64_3_s03); // 0x800D2A58

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CEB90_3_s03); // 0x800D2B84

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CEC88_3_s03); // 0x800D2C7C

s32 func_800D2EA0(void) // 0x800D2EA0 // 0x800D2EA0
{
    s32 temp_a0;

    temp_a0 = g_SysWork.field_2388.field_154.field_0.field_0.field_0 & 0x3;
    if (temp_a0 == 0)
    {
        return 0;
    }
    else if (temp_a0 == 2)
    {
        return 1;
    }
    else
    {
        return 2;
    }
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D2ED4);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D30A8);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D3288);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CF3AC_3_s03); // 0x800D33A0

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D35F4);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D37E8);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D3900);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CF9F8_3_s03); // 0x800D39EC

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CFD18_3_s03); // 0x800D3D0C

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800CFDD4_3_s03); // 0x800D3DC8

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800D0110_3_s03); // 0x800D4104

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CAD54);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CAD58);

#include "maps/shared/Ai_PuppetNurse_Control.h" // 0x800D41C4

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800D02E4_3_s03); // 0x800D42D8

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800D03E4_3_s03); // 0x800D43D8

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800D06AC_3_s03); // 0x800D46A0

#include "maps/shared/sharedFunc_800D0828_3_s03.h" // 0x800D481C

#include "maps/shared/sharedFunc_800D0968_3_s03.h" // 0x800D495C

#include "maps/shared/Ai_GhostChildAlessa_Update.h" // 0x800D49B8

#include "maps/shared/sharedFunc_800D4A2C_7_s01.h" // 0x800D4A2C

#include "maps/shared/sharedFunc_800D4A74_7_s01.h" // 0x800D4A74

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedFunc_800D4C0C_7_s01); // 0x800D4C0C

#include "maps/shared/Ai_GhostChildAlessa_Init.h" // 0x800D4DD8

#include "maps/shared/Ai_Lisa_Update.h" // 0x800D4DFC

#include "maps/shared/sharedFunc_800D08FC_3_s04.h" // 0x800D4E70

#include "maps/shared/sharedFunc_800D0944_3_s04.h" // 0x800D4EB8

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", sharedSymbol_800D0ADC_3_s04); // 0x800D5050

#include "maps/shared/Ai_Lisa_Init.h" // 0x800D58C4

#include "maps/shared/Ai_BloodyLisa_Update.h" // 0x800D58E8

#include "maps/shared/sharedFunc_800D595C_7_s01.h" // 0x800D595C

#include "maps/shared/sharedFunc_800D59A4_7_s01.h" // 0x800D59A4

#include "maps/shared/sharedFunc_800D5B3C_7_s01.h" // 0x800D5B3C

#include "maps/shared/Ai_BloodyLisa_Init.h" // 0x800D5CB4

#include "maps/shared/sharedFunc_800D88AC_0_s00.h" // 0x800D5CD8

#include "maps/shared/sharedFunc_800D88C0_0_s00.h" // 0x800D5CEC

#include "maps/shared/sharedFunc_800D8904_0_s00.h" // 0x800D5D30

#include "maps/shared/sharedFunc_800D891C_0_s00.h" // 0x800D5D48

#include "maps/shared/sharedFunc_800D8928_0_s00.h" // 0x800D5D54

#include "maps/shared/sharedFunc_800D893C_0_s00.h" // 0x800D5D68

#include "maps/shared/sharedFunc_800D8950_0_s00.h" // 0x800D5D7C

#include "maps/shared/sharedFunc_800D8964_0_s00.h" // 0x800D5D90

#include "maps/shared/sharedFunc_800D8A00_0_s00.h" // 0x800D5E7C

#include "maps/shared/sharedFunc_800D9064_0_s00.h" // 0x800D64E0

#include "maps/shared/sharedFunc_800D9078_0_s00.h" // 0x800D64F4

#include "maps/shared/sharedFunc_800D908C_0_s00.h" // 0x800D6508

#include "maps/shared/sharedFunc_800D9188_0_s00.h" // 0x800D6604

#include "maps/shared/Anim_StartKeyframeIdxGet.h" // 0x800D6698

#include "maps/shared/sharedFunc_800D923C_0_s00.h" // 0x800D6708

#include "maps/shared/sharedFunc_800D929C_0_s00.h" // 0x800D6768

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D6778);

void func_800D6810(s32 arg0) // 0x800D6810
{
    (arg0 != 0) ? func_800D6878() : func_800D6938();
}

void func_800D6844(s32 arg0) // 0x800D6844
{
    (arg0 != 0) ? func_800D68F8() : func_800D6938();
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D6878);

void func_800D68F8(void) // 0x800D68F8
{
    func_8003640C(Savegame_EventFlagGet(EventFlag_391) ? 40 : 35);
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D6938);

void func_800D71BC(void) {}

#include "maps/shared/sharedFunc_800DA8E8_0_s01.h" // 0x800D71C4

const char* MAP_MESSAGES[] =
{
    #include "maps/shared/mapMsg_common.h"
    "~J0(5.5)\t",
    "~J0(2.8)\tDamn! ~N\n\t\t\tWhat's_that? ~E ",
    "~J0(1.2)\tHarry? ~E ",
    "~J1(2.6)\tLisa... ~N\n\t\t\tWhat's_the_matter_with_you? ",
    "~J1(1.8)\tI_get_it_now... ",
    "~J1(4.0)\tWhy_I'm_still_alive_even ~N\n\t\t\tthough_everyone_else's_dead. ",
    "~J1(4.0)\tI'm_not_the_only_one ~N\n\t\t\twho's_still_walking_around. ",
    "~J1(1.7)\tI'm_the_same_as_them. ",
    "~J1(2.8)\tI_just_hadn't_noticed_it_before. ~E ",
    "~J1(1.3)\tLisa? ",
    "~J1(3.6)\tStay_by_me,_Harry. ~N\n\t\t\tPlease. ",
    "~J1(3.3)\tI'm_so_scared. ~N\n\t\t\tHelp_me... ~E ",
    "~J0(2.4)\tSave_me_from_them. ",
    "~J0(4.0)\tPlease...__Harry... ~E ",
    "~J0(8.9)\t~E ",
    "\t\tSame_thing... ~E ",
    "~L4 ~C3 Investigation_stalled. ~N\n\t[PTV]_dealers_still_at_large. ~N\n\t~N\n\tSuspicious_deaths_continue. ~N\n\tLike_the_anti-drug_mayor, ~N\n\ta_narcotics_officer_dies_of ~N\n\ta_sudden_heart_failure_of ~N\n\tunknown_origin. ~E ",
    "\t\tAre_there_others? ~N\n\t\tIt's_pretty_old... ",
    "~L4 ~C3 Fire_broke_out_in_town. ~N\n\t6_homes_destroyed. ~N\n\t~N\n\tCharred_body ~N\n\tof_Alessa_Gillespie(7) ~N\n\tfound_in_aftermath. ~N\n\t~N\n\tCause_of_fire_currently_under ~N\n\tinvestigation. ",
    "~L4 ~C3 Investigations_show_source ~N\n\tas_basement_of_Gillespie_home. ~N\n\tBlaze_now_believed_caused_by ~N\n\tmalfunction_of_antiquated ~N\n\tboiler. ~E ",
    "\tThe_date_of_the_blaze... ",
    "\tit's_the_same_day ~N\n\twe_found_Cheryl! ~E ",
    "\tThere's_a_place_mark ~N\n\tin_the_book... ~E ",
    "~L4 ~C3 WHITE_CLAUDIA. ~N\n\t~N\n\tPerennial_herb_found_near_water. ~N\n\tReaches_height_of_10_to_15_in. ~N\n\tOblong_leaves,_white_blossoms. ",
    "~L4 ~C3 Seeds_contain_hallucinogen. ~N\n\tAncient_records_show_it_was ~N\n\tused_for_religious_ceremonies. ~N\n\tThe_hallucinogenic_effect ~N\n\twas_key. ~E ",
    "~L4 ~C3 Ask_doctor_to_let_me_quit_being ~N\n\tin_charge_of_that_patient. ~N\n\t~N\n\tIt's_too_weird. ~E ",
    "~L4 ~C3 The_room_is_filled_with_insects. ~N\n\t~N\n\tEven_with_doors ~N\n\tand_windows_shut ~N\n\tthey_get_in_to_spite_me. ~N\n\t~N\n\tTo_the_hospital... ~E ",
    "~L4 ~C3 Still_alive, ~N\n\tbut_with_wounds_that_won't_heal. ~E ",
    "~L4 ~C3 Blood_and_pus_flow_from ~N\n\tthe_bathroom_faucet. ~N\n\t~N\n\tI_try_to_stop_it, ~N\n\tbut_it_won't_turn_off. ~E ",
    "~L4 ~C3 Feeling_bad. ~N\n\tNeed_to_throw_up. ~N\n\tBut_nothing_comes_out. ~N\n\tVomiting_only_bile. ~E ",
    "~L4 ~C3\tNeed_drug. ~E ",
    "~L4 ~C3 Told_the_doctor_I_quit. ~N\n\tWon't_work_at_that ~N\n\thospital_anymore. ~E ",
    "~L4 ~C3\tHelp_me... ~E ",
    "\tUsed_the_ ~C2 Key_of_[Ophiel] ~C7 . ~E ",
    "\tUsed_the_ ~C2 Key_of_[Hagith] ~C7 . ~E ",
    "\tUsed_the_ ~C2 Key_of_[Phaleg] ~C7 . ~E ",
    "\tThere_is_a_ ~C2 Ring_of_contract ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_are_ ~C2 Pliers ~C7 . ~N\n\tTake_them? ~S4 ",
    "\tThere_is_a_ ~C2 Screwdriver ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Bird_cage_key ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Camera ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Stone_of_time ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Key_of_[Ophiel] ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Key_of_[Hagith] ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Key_of_[Phaleg] ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_an_ ~C2 Amulet_of_Solomon ~C7 . ~N\n\tTake_it? ~S4 ",
    "\tThere_is_a_ ~C2 Crest_of_Mercury ~C7 . ~N\n\tTake_it? ~S4 ",
    "~C3\tGo_home. ",
    "~C3\tThief. ",
    "~C3\tDrop_dead. ~E ",
    "\tOld_clock. ~N\n\tThere_is_a_square_hole ~N\n\tin_the_center_of_the_clock. ",
    "\tThe_hands_of_the_clock ~N\n\t...it's_a_key. ",
    "\tI_can't_get_to_it_because ~N\n\tof_the_glass_cover. ~E ",
    "\tThere_is_a_key_in_the_faucet, ",
    "\tbut_I_can't_get_it_out_no_matter ~N\n\thow_much_I_pull. ~E ",
    "\tThere_is_a_slate. ~E ",
    "~C3\tNames_engraved ~N\n\t\tOn_a_lithograph. ~N\n\t\tThe_Grim_Reaper's_list. ",
    "~C3\tYes,_the_headcount_is_set ~N\n\t\tYoung_and_old_lined_up ~N\n\t\tIn_order_of_age. ",
    "~C3\tThen,_the_pathway_opens ~N\n\t\tAwaiting_them,_the_frenzied ~N\n\t\tUproar,_the_feast_of_death! ~E ",
    "\tThere_is_a_key. ",
    "\tElectricity_is_flowing_to_the_key. ~N\n\tI'll_get_shocked_if_I_grab_it_now. ~E ",
    "~C3\tThe_light_to_the_future. ~E ",
    "~C3\tThe_light_illuminating ~N\n\tthe_darkness. ~E ",
    "\tThe_bird_cage_is_locked._~E ",
    "\tUsed_the_ ~C2 Bird_cage_key ~C7 . ~E ",
    "\tBird_cage._It's_empty. ~E ",
    "\tIt's_locked. ",
    "\tThe_word,_[Ophiel] ~N\n\tis_carved_on_the_door. ~E ",
    "\tIt's_locked. ",
    "\tThe_word,_[Hagith] ~N\n\tis_carved_on_the_door. ~E ",
    "\tIt's_locked. ",
    "\tThe_word,_[Phaleg] ~N\n\tis_carved_on_the_door. ~E ",
    "\tA_steel_plate ~N\n\tis_screwed_to_the_wall. ~E ",
    "\tThe_elevator_doesn't ~N\n\tappear_to_be_working. ~E ",
    "\tThere's_a_clock ~N\n\twith_a_broken_face. ~E ",
    "\tNone_of_this_stuff_is_of_any_use. ~E ",
    "\tJust_a_wall. ~E ",
    "\tThere_is_a_diary_on_the_floor. ~E ",
    "\tNothing_helpful. ~E ",
    "\tLooks_like_an_altar. ~N\n\tWonder_what_they_worship? ~E ",
    "\tA_body_is_laid_out_on_the_bed. ~N\n\tDon't_feel_like_checking_this_out. ~E ",
    "\tThere's_a_botanical ~N\n\treference_book. ~N\n\tDon't_need_to_read_it_now. ~E "
};

void func_800D725C(void) // 0x800D725C
{
    s_FsImageDesc charaTex;

    if (g_Controller0->btnsClicked_10 & g_GameWorkPtr->config_0.controllerConfig_0.skip_4)
    {
        if (g_SysWork.sysStateStep_C[0] >= 4)
        {
            if (g_SysWork.sysStateStep_C[0] <= 20)
            {
                SysWork_NextStateStepSet(22);
            }
        }
    }

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            D_800E2C64 = 0;

            Fs_QueueStartRead(57, FS_BUFFER_4);
            Fs_QueueStartRead(145, FS_BUFFER_11);
            Fs_QueueWaitForEmpty();

            DmsHeader_FixOffsets((s_DmsHeader*)FS_BUFFER_11);
            D_800E2C68 = 0;
            func_800348C0();

            Chara_Load(0, Chara_Lisa, g_SysWork.npcCoords_FC0, CHARA_FORCE_FREE_ALL, NULL, NULL);

            ScreenFade_ResetTimestep();

            g_SysWork.field_30    = 20;
            g_SysWork.field_2378  = Q12(0.8f);
            g_SysWork.flags_22A4 |= 1 << 3;

            Game_TurnFlashlightOn();
            D_800E1670 = 0;
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 51, false);
            sharedFunc_800D2EB4_0_s00();
            func_8003D03C();
            func_8003640C(4);
            SysWork_StateStepIncrement();
        case 1:
            func_80087EDC(4);
            break;

        case 2:
            func_8008616C(2, false, 0, Q12(1.0f), false);
            break;

        case 3:
            func_80088D0C();
            Chara_Spawn(Chara_Lisa, 0, Q12(130.0f), Q12(-70.0f), FP_ANGLE(0.0f), 3);
            SysWork_StateStepIncrement();
        case 4:
            Map_MessageWithAudio(17, &D_800E2C64, &D_800E14E8);
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(20.0f), true, false);
            func_80085E6C(Q12(0.8f), false);
            break;

        case 5:
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 72, false);
            SysWork_StateStepIncrement();
        case 6:
            Map_MessageWithAudio(17, &D_800E2C64, &D_800E14E8);
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(20.0f), true, false);
            break;

        case 7:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(20.0f), true, true);
            break;

        case 8:
            func_80085EB8(0, &g_SysWork.npcs_1A0[0], 5, false);
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 51, false);
            D_800E2C68 = Q12(21.0f);
            SysWork_StateStepIncrement();
        case 9:
            Map_MessageWithAudio(18, &D_800E2C64, &D_800E14E8);
            break;

        case 10:
            Map_MessageWithAudio(24, &D_800E2C64, &D_800E14E8);
            break;

        case 11:
            func_80085EB8(0, &g_SysWork.npcs_1A0[0], 17, false);
            SysWork_StateStepIncrement();
        case 12:
            Map_MessageWithAudio(27, &D_800E2C64, &D_800E14E8);
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(22.0f), Q12(97.0f), false, false);
            break;

        case 13:
            SysWork_StateStepIncrement();
        case 14:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(22.0f), Q12(97.0f), false, true);
            break;

        case 15:
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 155, false);
            Sd_EngineCmd(Sfx_Unk4664);
            SysWork_StateStepIncrement();
        case 16:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(22.0f), Q12(132.0f), true, true);
            break;

        case 17:
            func_80085EB8(0, &g_SysWork.npcs_1A0[0], 18, false);
            Savegame_EventFlagSet(EventFlag_570);
            SysWork_StateStepIncrement();
        case 18:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(133.0f), Q12(157.0f), true, true);
            break;

        case 19:
            Chara_FsImageCalc(&charaTex, Chara_BloodyLisa, 2);
            Chara_Load(1, Chara_BloodyLisa, &g_SysWork.npcCoords_FC0[30], 0, (s_LmHeader*)0x8019E600, &charaTex);
            g_SysWork.player_4C.chara_0.position_18.vx = Q12(180.0f);
            g_SysWork.player_4C.chara_0.position_18.vz = Q12(-100.0f);
            func_8003C3AC();
            SysWork_StateStepIncrement();
        case 20:
            func_8008616C(2, true, 0, Q12(0.5f), false);
            break;

        case 21:
            SysWork_StateStepReset();
            break;

        case 22:
            func_8008616C(2, true, 0, Q12(0.0f), false);
            break;

        case 23:
            Savegame_EventFlagSet(EventFlag_571);
            SysWork_StateStepIncrement();
        case 24:
            g_SysWork.player_4C.chara_0.position_18.vx = Q12(180.0f);
            g_SysWork.player_4C.chara_0.position_18.vz = Q12(-100.0f);
            func_8003C3AC();
            Chara_FsImageCalc(&charaTex, Chara_BloodyLisa, 2);
            Chara_Load(1, Chara_BloodyLisa, &g_SysWork.npcCoords_FC0[30], 0, (s_LmHeader*)0x8019E600, &charaTex);
            func_80088D0C();
            SysWork_StateStepIncrement();
        default:
            SysWork_StateSetNext(SysState_Gameplay);
            Savegame_EventFlagSet(EventFlag_482);
            func_80088F94(&g_SysWork.npcs_1A0[0], 0, 0);
            func_80088D0C();
            Sd_EngineCmd(19);
            break;
    }

    if (D_800E2C68 >= 0)
    {
        Dms_CharacterGetPosRot(&g_SysWork.player_4C.chara_0.position_18, &g_SysWork.player_4C.chara_0.rotation_24, "HERO", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
        Dms_CharacterGetPosRot(&g_SysWork.npcs_1A0[0].position_18, &g_SysWork.npcs_1A0[0].rotation_24, "LISA", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
        vcChangeProjectionValue(Dms_CameraGetTargetPos(&D_800E2C48, &D_800E2C58, NULL, D_800E2C68, (s_DmsHeader*)FS_BUFFER_11));
        vcUserCamTarget(&D_800E2C48, NULL, true);
        vcUserWatchTarget(&D_800E2C58, NULL, true);
    }
}

void func_800D7A60(void) // 0x800D7A60
{
    VECTOR3  pos;
    SVECTOR3 rot;

    if (g_Controller0->btnsClicked_10 & g_GameWorkPtr->config_0.controllerConfig_0.skip_4)
    {
        if (g_SysWork.sysStateStep_C[0] >= 2)
        {
            if (g_SysWork.sysStateStep_C[0] <= 15)
            {
                SysWork_NextStateStepSet(17);
            }
        }
    }

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            Fs_QueueStartRead(146, FS_BUFFER_11);
            Fs_QueueWaitForEmpty();
            DmsHeader_FixOffsets((s_DmsHeader*)FS_BUFFER_11);
            Chara_Spawn(Chara_BloodyLisa, 0, g_SysWork.player_4C.chara_0.position_18.vx, g_SysWork.player_4C.chara_0.position_18.vz + Q12(1.0f), 0, 3);
            D_800E2C68 = 0;
            D_800E2C64 = 0;
            D_800E1671 = 0;
            SysWork_StateStepIncrement();
            break;

        case 1:
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 156, false);
            func_80085EB8(0, &g_SysWork.npcs_1A0[0], 6, false);
            func_8008616C(0, false, false, false, false);
            SysWork_StateStepIncrement();
        case 2:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(43.0f), true, true);
            break;

        case 3:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(44.0f), Q12(59.0f), true, true);
            break;

        case 4:
            func_80085EB8(0U, &g_SysWork.player_4C.chara_0, 157, false);
            g_SysWork.field_235C = NULL;
            g_SysWork.field_236C = NULL;
            g_SysWork.field_2378 = Q12(1.0f);
            func_8008D438();
            SysWork_StateStepIncrement();
        case 5:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(60.0f), Q12(76.0f), true, true);
            Dms_CharacterGetPosRot(&g_SysWork.field_2360, &rot, "LIGHT", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
            Dms_CharacterGetPosRot(&pos, &rot, "L_INT", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
            g_SysWork.field_2370.vx = -ratan2(pos.vy - g_SysWork.field_2360.vy, SquareRoot0(SQUARE((pos.vx - g_SysWork.field_2360.vx) >> 6) + SQUARE((pos.vz - g_SysWork.field_2360.vz) >> 6)) << 6);
            g_SysWork.field_2370.vy = ratan2(pos.vx - g_SysWork.field_2360.vx, pos.vz - g_SysWork.field_2360.vz);
            g_SysWork.field_2370.vz = 0;
            break;

        case 6:
            D_800E1671 = 1;
            func_8008D448();
            func_8003EBA0();
            g_SysWork.field_2378 = Q12(0.8f);
            func_8005DC1C(Sfx_Unk1336, &D_800E2C94.position_0, 128, 0);
            SysWork_StateStepIncrement();
        case 7:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(77.0f), Q12(100.0f), true, true);
            break;

        case 8:
            func_80085EB8(0U, &g_SysWork.player_4C.chara_0, 158, false);
            func_80088F94(&g_SysWork.npcs_1A0[0], 0, 0);
            func_8005DC1C(Sfx_Unk1337, &D_800E2C94.position_0, 128, 0);
            SysWork_StateStepIncrement();
        case 9:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(101.0f), Q12(152.0f), true, false);
            func_80085E6C(Q12(0.3f), false);
            break;

        case 10:
            Sd_EngineCmd(4662);
            SysWork_StateStepIncrement();
        case 11:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(101.0f), Q12(142.0f), false, true);
            break;

        case 12:
            SysWork_StateStepIncrement();
        case 13:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(101.0f), Q12(152.0f), true, false);
            func_8008616C(2, true, false, Q12(0.25f), false);
            break;

        case 14:
            if (func_80045B28())
            {
                break;
            }
            SysWork_StateStepIncrement();
        case 15:
            func_80085E6C(Q12(2.0f), false);
            break;

        case 16:
            // TODO: `SysWork_NextStateStepSet(19)`
            g_SysWork.sysStateStep_C[0] = 19;
            g_SysWork.field_28          = 0;
            g_SysWork.sysStateStep_C[1] = 0;
            g_SysWork.timer_2C          = 0;
            g_SysWork.sysStateStep_C[2] = 0;
            break;

        case 17:
            func_8008616C(2, true, false, false, false);
            break;

        case 18:
            Sd_EngineCmd(19);
            func_80088F94(&g_SysWork.npcs_1A0[0], 0, 0);
            SysWork_StateStepIncrement();
            break;

        case 19:
            GameFs_PlayerMapAnimLoad(g_SavegamePtr->mapOverlayId_A4);
            Fs_QueueWaitForEmpty();
            SysWork_StateStepIncrement();
        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            D_800E2C68 = NO_VALUE;
            vcReturnPreAutoCamWork(true);
            Savegame_EventFlagSet(EventFlag_484);
            func_8008616C(0, false, 2, false, false);
            func_8008D448();
            func_8003EBA0();
            g_SysWork.field_2378 = Q12(1.0f);
            Game_TurnFlashlightOn();
            sharedFunc_800D2EF4_0_s00();
            func_8003D01C();
            func_800348C0();
            func_8008616C(0, false, false, Q12(1.0f), false);
            break;
    }

    if (D_800E2C68 >= 0)
    {
        Dms_CharacterGetPosRot(&g_SysWork.player_4C.chara_0.position_18, &g_SysWork.player_4C.chara_0.rotation_24, "HERO", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
        Dms_CharacterGetPosRot(&g_SysWork.npcs_1A0[0].position_18, &g_SysWork.npcs_1A0[0].rotation_24, "BLS", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
        if (D_800E1671 != 0)
        {
            Dms_CharacterGetPosRot(&D_800E2C94.position_0, &D_800E2C94.rotation_C, "ADOOR", D_800E2C68, (s_DmsHeader*)FS_BUFFER_11);
        }
        vcChangeProjectionValue(Dms_CameraGetTargetPos(&D_800E2C48, &D_800E2C58, NULL, D_800E2C68, (s_DmsHeader*)FS_BUFFER_11));
        vcUserCamTarget(&D_800E2C48, NULL, true);
        vcUserWatchTarget(&D_800E2C58, NULL, true);
    }
}

void func_800D8230(void) // 0x800D8230
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(11, Sfx_Unk1334, &vec);
}

void func_800D82C4(void) // 0x800D82C4
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(12, Sfx_Unk1344, &vec);
}

void func_800D8358(void) // 0x800D8358
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(13, Sfx_Unk1342, &vec);
}

void func_800D83EC(void) // 0x800D83EC
{
    u32 pickupType;
    s32 eventFlagIdx;

    pickupType   = CommonPickupItemId_FirstAidKit;
    eventFlagIdx = 0;

    switch (g_MapEventParam->field_5)
    {
        case 170:
            pickupType   = CommonPickupItemId_RifleShells;
            eventFlagIdx = EventFlag_M7S01_RifleShells;
            break;

        case 171:
            pickupType   = CommonPickupItemId_HandgunBullets;
            eventFlagIdx = EventFlag_M7S01_HandgunBullets0;
            break;

        case 172:
            pickupType   = CommonPickupItemId_HealthDrink;
            eventFlagIdx = EventFlag_M7S01_HealthDrink0;
            break;

        case 173:
            pickupType   = CommonPickupItemId_HandgunBullets;
            eventFlagIdx = EventFlag_M7S01_HandgunBullets1;
            break;

        case 174:
            pickupType   = CommonPickupItemId_ShotgunShells;
            eventFlagIdx = EventFlag_M7S01_ShotgunShells;
            break;

        case 175:
            pickupType   = CommonPickupItemId_FirstAidKit;
            eventFlagIdx = EventFlag_M7S01_FirstAidKit;
            break;

        case 176:
            pickupType   = CommonPickupItemId_HandgunBullets;
            eventFlagIdx = EventFlag_M7S01_HandgunBullets2;
            break;

        case 177:
            pickupType   = CommonPickupItemId_HealthDrink;
            eventFlagIdx = EventFlag_M7S01_HealthDrink1;
            break;
    }

    Event_CommonItemTake(pickupType, eventFlagIdx);
}

void func_800D84AC(void) // 0x800D84AC
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(81, Sfx_Unk1344, &vec);
}

void func_800D8540(void) // 0x800D8540
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(83, Sfx_Unk1344, &vec);
}

void func_800D85D4(void) // 0x800D85D4
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_80086FE8(85, Sfx_Unk1344, &vec);
}

void func_800D8668(void) // 0x800D8668
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_8004EE94(78, 1);

    func_80086FE8(48, Sfx_Unk1335, &vec);

    Savegame_EventFlagSet(EventFlag_530);
}

void func_800D8724(void) // 0x800D8724
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_8004EE94(79, 1);

    func_80086FE8(49, Sfx_Unk1335, &vec);

    Savegame_EventFlagSet(EventFlag_531);
}

void func_800D87E0(void) // 0x800D87E0
{
    VECTOR3 vec = { D_800E00CC[g_MapEventParam->field_5].vx, Q12(-1.2f), D_800E00CC[g_MapEventParam->field_5].vz };

    func_8004EE94(80, 1);

    func_80086FE8(50, Sfx_Unk1335, &vec);

    Savegame_EventFlagSet(EventFlag_532);
}

void func_800D889C(void) // 0x800D889C
{
    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            D_800E2C64 = 0;
            SysWork_StateStepIncrement();
        case 1:
            Map_MessageWithAudio(15, &D_800E2C64, &D_800E1500);
            break;

        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            break;
    }
}

void func_800D8958(void) // 0x800D8958
{
    func_80087360(FILE_TIM_BIRDCAGE_TIM, Q12(0.0f), Q12(0.0f), 78);
}

void func_800D8984(void) // 0x800D8984
{
    const static VECTOR3 D_800CC528 = { Q12(-179.64f), Q12(-1.0f), Q12(-20.05f) };

    func_80086FE8(79, Sfx_Unk1645, &D_800CC528);

    func_8004EE94(117, 1);

    Savegame_EventFlagSet(EventFlag_491);
}

void func_800D89D8(void) // 0x800D89D8
{
    Event_ItemTake(InventoryItemId_KeyOfPhaleg, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupKeyOfPhaleg, 59);
}

void func_800D8A04(void) // 0x800D8A04
{
    func_80087360(FILE_TIM_CAGEEMPT_TIM, Q12(0.0f), Q12(0.0f), 80);
}

void func_800D8A30(void) // 0x800D8A30
{
    func_80087360(FILE_TIM_WATERTAP_TIM, Q12(0.0f), Q12(0.0f), 68);
}

void func_800D8A5C(void) // 0x800D8A5C
{
    const static VECTOR3 D_800CC534 = { Q12(-140.05f), Q12(-1.4f), Q12(-22.15f) };
    const static VECTOR3 D_800CC540 = { Q12(-140.05f), Q12(0.0f), Q12(-22.15f) };

    s32 i;

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();

            D_800E1678[0] = Q12(1.9f);
            D_800E1678[1] = Q12(1.5f);
            D_800E1678[2] = Q12(1.5f);
            D_800E1678[3] = Q12(0.4f);

            func_8008616C(false, true, 2, 0, false);
            sharedFunc_800D2EB4_0_s00();
            func_8003D03C();
            SysWork_StateStepIncrement();
        case 1:
            func_80085DF0();
            break;

        case 2:
            func_8008616C(1, true, 2, 0, false);
            break;

        case 3:
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 145, false);
            Camera_PositionSet(NULL, Q12(-139.38f), Q12(-0.92f), Q12(-19.99f), 0, 0, 0, 0, true);
            Camera_LookAtSet(NULL, Q12(-141.0f), Q12(-1.64f), Q12(-23.58f), 0, 0, 0, 0, true);
            g_SysWork.player_4C.chara_0.position_18.vx = Q12(-140.0f);
            g_SysWork.player_4C.chara_0.position_18.vz = Q12(-21.7f);
            g_SysWork.player_4C.chara_0.rotation_24.vy = Q12(0.5f);
            SysWork_StateStepIncrement();
        case 4:
            for (i = 0; i < 4; i++)
            {
                if (D_800E1678[i] > 0)
                {
                    D_800E1678[i] -= g_DeltaTime0;

                    if (D_800E1678[i] > 0)
                    {
                        break;
                    }

                    D_800E1678[i] = 0;

                    if (i == 3)
                    {
                        SysWork_StateStepIncrement();
                        break;
                    }

                    func_8005DC1C(Sfx_Unk1642, &D_800CC534, 128, 0);
                    break;
                }
            }
            break;

        case 5:
            func_8005DC1C(Sfx_Unk1643, &D_800CC540, 128, 0);
            SysWork_StateStepIncrement();
        case 6:
            func_80085EB8(1, &g_SysWork.player_4C.chara_0, 0, false);
            break;

        case 7:
            func_8008616C(2, true, 0, 0, false);
            break;

        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            sharedFunc_800D2EF4_0_s00();
            func_8003D01C();
            vcReturnPreAutoCamWork(true);
            func_8008616C(0, false, 2, 0, false);
            func_8008616C(0, false, 0, 0, false);
            Savegame_EventFlagSet(EventFlag_490);
            break;
    }
}

void func_800D8DB4(void) // 0x800D8DB4
{
    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            func_80086470(0, 78, 0, false);
            SysWork_StateStepIncrement();
        case 1:
            func_80085DF0();
            break;

        case 2:
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 59, false);
            SysWork_StateStepIncrement();
        case 3:
            func_80086470(1, 78, 0, false);
            break;

        case 4:
            func_80085EB8(1, &g_SysWork.player_4C.chara_0, 0, false);
            break;

        case 5:
            if (Gfx_PickupItemAnimate(78))
            {
                MapMsg_DisplayAndHandleSelection(true, 57, 6, 7, 0, false);
            }
            Savegame_EventFlagSet(EventFlag_525);
            break;

        case 6:
            func_80086470(3, 78, 1, false);
            // TODO: `SysWork_NextStateStepSet(8);`
            g_SysWork.sysStateStep_C[0] = 8;
            g_SysWork.field_28          = 0;
            g_SysWork.sysStateStep_C[1] = 0;
            g_SysWork.timer_2C          = 0;
            g_SysWork.sysStateStep_C[2] = 0;
            break;

        case 7:
            Savegame_EventFlagClear(EventFlag_525);
            SysWork_StateStepIncrement();
        case 8:
            func_80086C58(&g_SysWork.player_4C.chara_0, 60);
            break;

        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            break;
    }
}

void func_800D8FCC(void) // 0x800D8FCC
{
    func_80087360(FILE_TIM_CLOCKKEY_TIM, Q12(0.0f), Q12(0.0f), 65);
}

void func_800D8FF8(void) // 0x800D8FF8
{
    const static VECTOR3 D_800CC594 = { Q12(-16.6661f), Q12(-1.234f), Q12(-61.49756f) };
    const static VECTOR3 D_800CC5A0 = { Q12(-16.6661f), Q12(-1.234f), Q12(-61.69751f) };
    const static VECTOR3 D_800CC5AC = { Q12(-15.8f), Q12(-1.23f), Q12(-60.22f) };
    const static VECTOR3 D_800CC5B8 = { Q12(-16.7f), Q12(-1.5f), Q12(-60.8f) };

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            ScreenFade_ResetTimestep();
            g_SysWork.field_30 = 20;

            Fs_QueueStartReadTim(FILE_TIM_GLASS_TIM, FS_BUFFER_1, &D_800A908C);
            Savegame_EventFlagSet(EventFlag_563);
            func_8005DC1C(Sfx_Unk1660, &D_800E1504, 128, 0);

            D_800E1680 = 0;

            Camera_PositionSet(NULL, Q12(-15.39f), Q12(-3.6f), Q12(-61.47f), 0, 0, 0, 0, true);
            Camera_LookAtSet(NULL, Q12(-17.38f), Q12(-0.18f), Q12(-60.85f), 0, 0, 0, 0, true);

            g_SysWork.player_4C.chara_0.position_18.vx = Q12(-16.7f);
            g_SysWork.player_4C.chara_0.position_18.vz = Q12(-61.15f);
            g_SysWork.player_4C.chara_0.rotation_24.vy = Q12(0.5f);

            SysWork_StateStepIncrement();
        case 1:
            func_8008616C(2, false, 0, 0, false);
            break;

        case 3:
            if (Fs_QueueDoThingWhenEmpty() != false)
            {
                SysWork_StateStepIncrement();
            }
            break;

        case 4:
            if (g_SysWork.field_28 == 0)
            {
                func_8005DC1C(Sfx_Unk1661, &D_800E1504, 128, 0);

                D_800E1680++;
                if (D_800E1680 == 5)
                {
                    SysWork_StateStepIncrement();
                }
                else
                {
                    g_SysWork.field_28++;
                }
                break;
            }

            g_SysWork.field_28 += g_DeltaTime0;
            if (g_SysWork.field_28 > Q12(1.4f))
            {
                g_SysWork.field_28 = 0;
            }
            break;

        case 5:
            func_80085E6C(Q12(2.5f), false);
            break;

        case 6:
            func_800CC9A4(&D_800CC594, &D_800CC5A0, Q12(2.4f), 90, Q12(0.18f), Q12(0.2f), 204, 0);
            func_8005DC1C(Sfx_Unk1658, &D_800CC5AC, 128, 0);
            func_80085EB8(0U, &g_SysWork.player_4C.chara_0, 167, false);
            SysWork_StateStepIncrement();
        case 7:
            func_80085E6C(Q12(0.2f), false);
            break;

        case 8:
            func_8005DC1C(Sfx_Unk1327, &D_800CC5B8, 128, 0);
            SysWork_StateStepIncrement();
        case 2:
        case 9:
            func_80085E6C(Q12(1.0), false);
            break;

        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            vcReturnPreAutoCamWork(true);
            g_SysWork.player_4C.chara_0.position_18.vz = Q12(-60.7f);
            func_8008616C(0, false, 2, 0, false);
            Savegame_EventFlagSet(EventFlag_489);
            break;
    }
}

void func_800D93BC(void) // 0x800D93BC
{
    Event_ItemTake(InventoryItemId_KeyOfHagith, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupKeyOfHagith, 58);
}

void func_800D93E8(void) // 0x800D93E8
{
    func_80087360(FILE_TIM_ABUSEDSK_TIM, Q12(0.0f), Q12(0.0f), 62);
}

void func_800D9414(void) // 0x800D9414
{
    Event_ItemTake(InventoryItemId_Pliers, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupPliers, 52);
}

void func_800D9440(void) // 0x800D9440
{
    Event_ItemTake(InventoryItemId_Screwdriver, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupScrewdriver, 53);
}

void func_800D946C(void) // 0x800D946C
{
    g_BackgroundColor = 0x68;
    func_80087360(FILE_TIM_LITHGRPH_TIM, Q12(0.0f), Q12(0.0f), 70);
}

void func_800D94A4(void) // 0x800D94A4
{
    g_BackgroundColor = 0x68;
    func_80087360(FILE_TIM_LITHGR_3_TIM, Q12(0.0f), Q12(0.0f), 71);
}

void func_800D94DC(void) // 0x800D94DC
{
    s32         i;
    s32         j;
    s_800E1510* var_s1;

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            func_8008616C(0, true, 0, 0, false);
            D_800E2CAC = 0;
            D_800E2CA8 = 0;
            for (i = 0; i < 5; i++)
            {
                D_800E1688[i] = 26; // Sets all 5 values to length of `D_800E1510` array?
            }
            SysWork_StateStepIncrement();
        case 1:
            func_800862F8(7, FILE_TIM_ALERTDOR_TIM, false);
            break;

        case 2:
            func_8008616C(1, true, 0, 0, false);
            break;

        case 3:
            func_8008616C(2, false, 0, 0, false);
            func_800862F8(2, 0, false);
            break;

        case 4:
            func_800862F8(2, 0, false);

            D_800E2CA8 += (g_Controller0->sticks_24.sticks_0.leftX * 16384) / 75;
            D_800E2CA8  = CLAMP_RANGE(D_800E2CA8, Q12(-120.0f), Q12(120.0f));

            D_800E2CAC += (g_Controller0->sticks_24.sticks_0.leftY * 16384) / 75;
            D_800E2CAC  = CLAMP_RANGE(D_800E2CAC, Q12(-120.0f), Q12(120.0f));

            Game_TimerUpdate();
            func_800881B8((s16)(FP_FROM(D_800E2CA8, Q12_SHIFT) + 8), FP_FROM(D_800E2CAC, Q12_SHIFT) + 8, 8, 8, 0, 64, 32, 32, 128, 192, 0, 12);

            if (g_Controller0->btnsClicked_10 & g_GameWorkPtr->config_0.controllerConfig_0.cancel_2)
            {
                // TODO: `SysWork_NextStateStepSet(8);`
                g_SysWork.sysStateStep_C[0] = 8;
                g_SysWork.field_28          = 0;
                g_SysWork.sysStateStep_C[1] = 0;
                g_SysWork.timer_2C          = 0;
                g_SysWork.sysStateStep_C[2] = 0;
                break;
            }

            if (g_Controller0->btnsClicked_10 & g_GameWorkPtr->config_0.controllerConfig_0.enter_0)
            {
                for (i = 0; i < 26; i++)
                {
                    var_s1 = &D_800E1510[i];
                    if (var_s1->field_0 - 174 <= FP_FROM(D_800E2CA8, Q12_SHIFT) &&
                        var_s1->field_0 - 146 >= FP_FROM(D_800E2CA8, Q12_SHIFT))
                    {
                        if (var_s1->field_1 - 134 <= FP_FROM(D_800E2CAC, Q12_SHIFT) &&
                            var_s1->field_1 - 106 >= FP_FROM(D_800E2CAC, Q12_SHIFT))
                        {
                            if (SQUARE(var_s1->field_0 - 160 - FP_FROM(D_800E2CA8, Q12_SHIFT)) +
                                SQUARE(var_s1->field_1 - 120 - FP_FROM(D_800E2CAC, Q12_SHIFT)) < 197)
                            {
                                Sd_EngineCmd(Sfx_Unk1650);

                                for (j = 0; j < 4; j++)
                                {
                                    D_800E1688[j] = D_800E1688[j + 1];
                                }
                                
                                D_800E1688[4] = i;

                                for (j = 0; j < 5; j++)
                                {
                                    if (D_800E1688[j] != D_800E1544[j])
                                    {
                                        break;
                                    }
                                }

                                if (j == 5)
                                {
                                    Savegame_EventFlagSet(EventFlag_488);

                                    // TODO: `SysWork_NextStateStepSet(5);`
                                    g_SysWork.sysStateStep_C[0] = 5;
                                    g_SysWork.field_28          = 0;
                                    g_SysWork.sysStateStep_C[1] = 0;
                                    g_SysWork.timer_2C          = 0;
                                    g_SysWork.sysStateStep_C[2] = 0;
                                }
                            }
                        }
                    }
                }
            }
            break;

        case 6:
            Sd_EngineCmd(Sfx_Unk1343);
            SysWork_StateStepIncrement();
        case 5:
        case 7:
            func_80085E6C(Q12(0.6f), false);
            func_800862F8(2, 0, false);
            break;

        case 8:
            func_800862F8(2, 0, false);
            func_8008616C(2, true, 0, 0, false);
            break;

        default:
            sharedFunc_800D2244_0_s00(false);
            SysWork_StateSetNext(SysState_Gameplay);
            func_8008616C(0, false, 0, 0, false);
            break;
    }
}

void func_800D99DC(void) // 0x800D99DC
{
    Event_ItemTake(InventoryItemId_AmuletOfSolomon, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupAmuletOfSolomon, 60);
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D9A08);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800D9C9C);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC65C);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", jtbl_800CC668);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", jtbl_800CC6A8);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DAB64);

void func_800DAD7C(void) // 0x800DAD7C
{
    Event_ItemTake(InventoryItemId_CrestOfMercury, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupCrestOfMercury, 61);
}

void func_800DADA8(void) // 0x800DADA8
{
    Event_ItemTake(InventoryItemId_RingOfContract, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupRingOfContract, 51);
}

void func_800DADD4(void) // 0x800DADD4
{
    Event_ItemTake(InventoryItemId_Camera, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupCamera, 55);
}

void func_800DAE00(void) // 0x800DAE00
{
    const static VECTOR3 D_800CC6E4 = { Q12(-63.2f), Q12(-1.45f), Q12(-139.05f) };
    const static VECTOR3 D_800CC6F0 = { Q12(-62.9f), Q12(0.0f), Q12(-139.1f) };

    s16* var_s0;

    switch (g_SysWork.sysStateStep_C[0])
    {
        case 0:
            sharedFunc_800D20E4_0_s00();
            g_SysWork.field_30    = 20;
            g_SysWork.flags_22A4 |= 1 << 3;
            Fs_QueueStartRead(42, (void*)0x80169600);
            Fs_QueueWaitForEmpty();
            DmsHeader_FixOffsets((s_DmsHeader*)0x80169600);
            func_80085EB8(0, &g_SysWork.player_4C.chara_0, 148, false);
            func_8008616C(0, false, 0, 0, false);
            D_800E1690.field_2 = Q12(0.3f);
            D_800E2C68         = 0;
            SysWork_StateStepIncrement();
        case 1:
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(31.0f), false, true);
            // TODO: Possible inline?
            var_s0 = &D_800E1690.field_2;
            if (*var_s0 == 0)
            {
                func_8005DC1C(Sfx_Unk1656, &D_800CC6E4, 128, 0);
                *var_s0 = Q12(1.2f);
            }
            else
            {
                *var_s0 -= g_DeltaTime0;
                if (*var_s0 < 0)
                {
                    *var_s0 = 0;
                }
            }
            break;

        case 2:
            func_8008616C(2, true, 0, 0, false);
            sharedFunc_800DA8E8_0_s01(&D_800E2C68, Q12(10.0f), Q12(0.0f), Q12(32.0f), true, false);
            // TODO: Possible inline?
            var_s0 = &D_800E1690.field_2;
            if (*var_s0 == 0)
            {
                func_8005DC1C(Sfx_Unk1656, &D_800CC6E4, 128, 0);
                *var_s0 = Q12(1.2f);
            }
            else
            {
                *var_s0 -= g_DeltaTime0;
                if (*var_s0 < 0)
                {
                    *var_s0 = 0;
                }
            }
            break;

        case 3:
            func_8005DC1C(Sfx_Unk1655, &D_800CC6F0, 128, 0);
            SysWork_StateStepIncrement();
        case 4:
            func_80085E6C(Q12(0.5f), false);
            break;

        default:
            sharedFunc_800D2244_0_s00(true);
            SysWork_StateSetNext(SysState_Gameplay);
            vcReturnPreAutoCamWork(true);
            D_800E2C68 = NO_VALUE;
            Savegame_EventFlagSet(EventFlag_486);
            func_8008616C(0, false, 0, 0, false);
            func_8008616C(0, false, 2, 0, false);
            break;
    }

    if (D_800E2C68 >= 0)
    {
        Dms_CharacterGetPosRot(&g_SysWork.player_4C.chara_0.position_18, &g_SysWork.player_4C.chara_0.rotation_24, "HERO", D_800E2C68, (s_DmsHeader*)0x80169600);
        vcChangeProjectionValue(Dms_CameraGetTargetPos(&D_800E2C48, &D_800E2C58, NULL, D_800E2C68, (s_DmsHeader*)0x80169600));
        vcUserCamTarget(&D_800E2C48, NULL, true);
        vcUserWatchTarget(&D_800E2C58, NULL, true);
    }
}

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DB13C);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DB1F0);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DB31C);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DB3D0);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DB60C);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC754);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DBDE0);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DC028);

void func_800DC080(void) // 0x800DC080
{
    Event_ItemTake(InventoryItemId_BirdCageKey, DEFAULT_PICKUP_ITEM_COUNT, EventFlag_M7S01_PickupBirdCageKey, 54);
}

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC788);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC794);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DC0AC);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DCE20);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DD348);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DD368);

INCLUDE_ASM("asm/maps/map7_s01/nonmatchings/map7_s01", func_800DDCD4);

void func_800DEDA4(void) // 0x800DEDA4
{
    if (!Savegame_EventFlagGet(EventFlag_485))
    {
        if (D_800A9945 != Chara_GhostChildAlessa || !func_80040B74(Chara_GhostChildAlessa))
        {
            func_800348C0();
            Chara_Load(0, Chara_GhostChildAlessa, g_SysWork.npcCoords_FC0, CHARA_FORCE_FREE_ALL, NULL, NULL);
            func_80088D0C();
        }
    }
    else if (D_800A9945 == Chara_PuppetNurse)
    {
        if (!func_80040B74(Chara_PuppetNurse))
        {
            g_MapOverlayHeader.charaGroupIds_248[0] = Chara_PuppetNurse;

            func_800348C0();
            Chara_Load(0, Chara_PuppetNurse, g_SysWork.npcCoords_FC0, CHARA_FORCE_FREE_ALL, NULL, NULL);
            func_80088D0C();
        }
    }
    else
    {
        g_MapOverlayHeader.charaGroupIds_248[0] = Chara_PuppetNurse;

        func_800348C0();
        Chara_Load(0, Chara_PuppetNurse, g_SysWork.npcCoords_FC0, CHARA_FORCE_FREE_ALL, NULL, NULL);
        func_80088D0C();
    }

    if (Savegame_EventFlagGet(EventFlag_521))
    {
        if (g_SavegamePtr->gameDifficulty_260 != GameDifficulty_Easy)
        {
            func_80088FF4(16, 2, 27);
        }

        func_80088FF4(16, 3, 27);
    }
    else if (Savegame_EventFlagGet(EventFlag_485))
    {
        func_80088FF4(16, 0, 19);
        func_80088FF4(16, 1, 19);
    }

    if (Savegame_EventFlagGet(EventFlag_525) && g_SavegamePtr->gameDifficulty_260 != GameDifficulty_Easy)
    {
        func_80088FF4(16, 12, 19);
        func_80088FF4(16, 13, 23);
        func_80088FF4(16, 14, 27);
    }
}

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC984);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC990);

INCLUDE_RODATA("asm/maps/map7_s01/nonmatchings/map7_s01", D_800CC998);
