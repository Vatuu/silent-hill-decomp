#include "common.h"

#include <libapi.h>

#include "bodyprog/libsd.h"

s32 sd_interrupt_start_flag = 0;
s16 sd_keyoff_mode = 0;
// 2 bytes of padding.
s32 sd_mono_st_flag = 0;
s32 sd_reverb_mode = 0;
u32 body_partly_size = 0;
s32 sd_reverb_area_size[10] =
{
    0x00000080, 0x000026C0, 0x00001F40, 0x00004840, 0x00006FE0,
    0x0000ADE0, 0x0000F6C0, 0x00018040, 0x00018040, 0x00003C00
};

u32 _spu_rev_param[172] =
{
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x005B007D, 0x54B86D80, 0x0000BED0, 0xBA800000, 0x53005800, 0x033304D6,
    0x022703F0, 0x01EF0374, 0x01B50334, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x013601B4,
    0x005C00B8, 0x80008000, 0x00000000, 0x00250033, 0x4FA870F0, 0x4410BCE0, 0x9C00C0F0, 0x4EC05280,
    0x031B03E4, 0x02AF03A4, 0x02660372, 0x025D031C, 0x018E025C, 0x0135022F, 0x00B701D2, 0x00B5018F,
    0x008000B4, 0x0026004C, 0x80008000, 0x00000000, 0x007F00B1, 0x4FA870F0, 0x4510BCE0, 0xB4C0BEF0,
    0x4EC05280, 0x076B0904, 0x065F0824, 0x061607A2, 0x05ED076C, 0x042E05EC, 0x0305050F, 0x02B70462,
    0x0265042F, 0x01B20264, 0x00800100, 0x80008000, 0x00000000, 0x00A900E3, 0x4FA86F60, 0x4510BCE0,
    0xA680BEF0, 0x52C05680, 0x0B580DFB, 0x0A3C0D09, 0x09730BD9, 0x08DA0B59, 0x05E908D9, 0x04B007EC,
    0x03D206EF, 0x031D05EA, 0x0238031C, 0x00AA0154, 0x80008000, 0x00000000, 0x013901A5, 0x50006000,
    0xB8004C00, 0xC000BC00, 0x5C006000, 0x11BB15BA, 0x10BD14C2, 0x0DC111BC, 0x0DC311C0, 0x09C10DC0,
    0x07C10BC4, 0x06CD0A00, 0x05C109C2, 0x041A05C0, 0x013A0274, 0x80008000, 0x00000000, 0x0231033D,
    0x50007E00, 0xB000B400, 0xB0004C00, 0x54006000, 0x1A311ED6, 0x183B1D14, 0x16B21BC2, 0x15EF1A32,
    0x105515EE, 0x0F2D1334, 0x0C5D11F6, 0x0AE11056, 0x07A20AE0, 0x02320464, 0x80008000, 0x00000000,
    0x00010001, 0x7FFF7FFF, 0x00000000, 0x81000000, 0x00000000, 0x0FFF1FFF, 0x00051005, 0x00000000,
    0x00051005, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x10021004, 0x00020004, 0x80008000,
    0x00000000, 0x00010001, 0x7FFF7FFF, 0x00000000, 0x00000000, 0x00000000, 0x0FFF1FFF, 0x00051005,
    0x00000000, 0x00051005, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x10021004, 0x00020004,
    0x80008000, 0x00000000, 0x00130017, 0x4FA870F0, 0x4510BCE0, 0x8500BEF0, 0x54C05F80, 0x02AF0371,
    0x01DF02E5, 0x01D702B0, 0x026A0358, 0x011E01D6, 0x00B1012D, 0x0059011F, 0x00E301A0, 0x00400058,
    0x00140028, 0x80008000, 0x00000000, 0x00000000
};

u16 PitchTbl[12][128] =
{
    {
        0x1000, 0x1001, 0x1003, 0x1005, 0x1007, 0x1009, 0x100B, 0x100C, 0x100E, 0x1010, 0x1012, 0x1014, 0x1016, 0x1018, 0x1019, 0x101B,         
        0x101D, 0x101F, 0x1021, 0x1023, 0x1025, 0x1027, 0x1028, 0x102A, 0x102C, 0x102E, 0x1030, 0x1032, 0x1034, 0x1035, 0x1037, 0x1039,         
        0x103B, 0x103D, 0x103F, 0x1041, 0x1043, 0x1044, 0x1046, 0x1048, 0x104A, 0x104C, 0x104E, 0x1050, 0x1052, 0x1054, 0x1055, 0x1057,         
        0x1059, 0x105B, 0x105D, 0x105F, 0x1061, 0x1063, 0x1065, 0x1066, 0x1068, 0x106A, 0x106C, 0x106E, 0x1070, 0x1072, 0x1074, 0x1076,         
        0x1078, 0x1079, 0x107B, 0x107D, 0x107F, 0x1081, 0x1083, 0x1085, 0x1087, 0x1089, 0x108B, 0x108D, 0x108E, 0x1090, 0x1092, 0x1094,         
        0x1096, 0x1098, 0x109A, 0x109C, 0x109E, 0x10A0, 0x10A2, 0x10A4, 0x10A5, 0x10A7, 0x10A9, 0x10AB, 0x10AD, 0x10AF, 0x10B1, 0x10B3,         
        0x10B5, 0x10B7, 0x10B9, 0x10BB, 0x10BD, 0x10BF, 0x10C0, 0x10C2, 0x10C4, 0x10C6, 0x10C8, 0x10CA, 0x10CC, 0x10CE, 0x10D0, 0x10D2,         
        0x10D4, 0x10D6, 0x10D8, 0x10DA, 0x10DC, 0x10DE, 0x10E0, 0x10E1, 0x10E3, 0x10E5, 0x10E7, 0x10E9, 0x10EB, 0x10ED, 0x10EF, 0x10F1,         
    },
    {
        0x10F3, 0x10F5, 0x10F7, 0x10F9, 0x10FB, 0x10FD, 0x10FF, 0x1101, 0x1103, 0x1105, 0x1107, 0x1109, 0x110B, 0x110D, 0x110F, 0x1111,         
        0x1113, 0x1114, 0x1116, 0x1118, 0x111A, 0x111C, 0x111E, 0x1120, 0x1122, 0x1124, 0x1126, 0x1128, 0x112A, 0x112C, 0x112E, 0x1130,         
        0x1132, 0x1134, 0x1136, 0x1138, 0x113A, 0x113C, 0x113E, 0x1140, 0x1142, 0x1144, 0x1146, 0x1148, 0x114A, 0x114C, 0x114E, 0x1150,         
        0x1152, 0x1154, 0x1156, 0x1158, 0x115A, 0x115C, 0x115E, 0x1160, 0x1162, 0x1164, 0x1166, 0x1168, 0x116A, 0x116C, 0x116E, 0x1170,         
        0x1172, 0x1174, 0x1176, 0x1178, 0x117A, 0x117C, 0x117E, 0x1180, 0x1182, 0x1184, 0x1186, 0x1188, 0x118A, 0x118D, 0x118F, 0x1191,         
        0x1193, 0x1195, 0x1197, 0x1199, 0x119B, 0x119D, 0x119F, 0x11A1, 0x11A3, 0x11A5, 0x11A7, 0x11A9, 0x11AB, 0x11AD, 0x11AF, 0x11B1,         
        0x11B3, 0x11B5, 0x11B7, 0x11B9, 0x11BB, 0x11BD, 0x11BF, 0x11C2, 0x11C4, 0x11C6, 0x11C8, 0x11CA, 0x11CC, 0x11CE, 0x11D0, 0x11D2,         
        0x11D4, 0x11D6, 0x11D8, 0x11DA, 0x11DC, 0x11DE, 0x11E0, 0x11E2, 0x11E5, 0x11E7, 0x11E9, 0x11EB, 0x11ED, 0x11EF, 0x11F1, 0x11F3,         
    },
    {
        0x11F5, 0x11F7, 0x11F9, 0x11FB, 0x11FD, 0x11FF, 0x1202, 0x1204, 0x1206, 0x1208, 0x120A, 0x120C, 0x120E, 0x1210, 0x1212, 0x1214,         
        0x1216, 0x1219, 0x121B, 0x121D, 0x121F, 0x1221, 0x1223, 0x1225, 0x1227, 0x1229, 0x122B, 0x122D, 0x1230, 0x1232, 0x1234, 0x1236,         
        0x1238, 0x123A, 0x123C, 0x123E, 0x1240, 0x1243, 0x1245, 0x1247, 0x1249, 0x124B, 0x124D, 0x124F, 0x1251, 0x1253, 0x1256, 0x1258,         
        0x125A, 0x125C, 0x125E, 0x1260, 0x1262, 0x1264, 0x1267, 0x1269, 0x126B, 0x126D, 0x126F, 0x1271, 0x1273, 0x1275, 0x1278, 0x127A,         
        0x127C, 0x127E, 0x1280, 0x1282, 0x1284, 0x1287, 0x1289, 0x128B, 0x128D, 0x128F, 0x1291, 0x1293, 0x1296, 0x1298, 0x129A, 0x129C,         
        0x129E, 0x12A0, 0x12A2, 0x12A5, 0x12A7, 0x12A9, 0x12AB, 0x12AD, 0x12AF, 0x12B2, 0x12B4, 0x12B6, 0x12B8, 0x12BA, 0x12BC, 0x12BE,         
        0x12C1, 0x12C3, 0x12C5, 0x12C7, 0x12C9, 0x12CC, 0x12CE, 0x12D0, 0x12D2, 0x12D4, 0x12D6, 0x12D9, 0x12DB, 0x12DD, 0x12DF, 0x12E1,         
        0x12E3, 0x12E6, 0x12E8, 0x12EA, 0x12EC, 0x12EE, 0x12F1, 0x12F3, 0x12F5, 0x12F7, 0x12F9, 0x12FC, 0x12FE, 0x1300, 0x1302, 0x1304,         
    },
    {
        0x1306, 0x1309, 0x130B, 0x130D, 0x130F, 0x1311, 0x1314, 0x1316, 0x1318, 0x131A, 0x131D, 0x131F, 0x1321, 0x1323, 0x1325, 0x1328,         
        0x132A, 0x132C, 0x132E, 0x1330, 0x1333, 0x1335, 0x1337, 0x1339, 0x133C, 0x133E, 0x1340, 0x1342, 0x1344, 0x1347, 0x1349, 0x134B,         
        0x134D, 0x1350, 0x1352, 0x1354, 0x1356, 0x1359, 0x135B, 0x135D, 0x135F, 0x1361, 0x1364, 0x1366, 0x1368, 0x136A, 0x136D, 0x136F,         
        0x1371, 0x1373, 0x1376, 0x1378, 0x137A, 0x137C, 0x137F, 0x1381, 0x1383, 0x1385, 0x1388, 0x138A, 0x138C, 0x138E, 0x1391, 0x1393,         
        0x1395, 0x1397, 0x139A, 0x139C, 0x139E, 0x13A1, 0x13A3, 0x13A5, 0x13A7, 0x13AA, 0x13AC, 0x13AE, 0x13B0, 0x13B3, 0x13B5, 0x13B7,         
        0x13BA, 0x13BC, 0x13BE, 0x13C0, 0x13C3, 0x13C5, 0x13C7, 0x13CA, 0x13CC, 0x13CE, 0x13D0, 0x13D3, 0x13D5, 0x13D7, 0x13DA, 0x13DC,         
        0x13DE, 0x13E0, 0x13E3, 0x13E5, 0x13E7, 0x13EA, 0x13EC, 0x13EE, 0x13F1, 0x13F3, 0x13F5, 0x13F7, 0x13FA, 0x13FC, 0x13FE, 0x1401,         
        0x1403, 0x1405, 0x1408, 0x140A, 0x140C, 0x140F, 0x1411, 0x1413, 0x1416, 0x1418, 0x141A, 0x141D, 0x141F, 0x1421, 0x1423, 0x1426,         
    },
    {
        0x1428, 0x142A, 0x142D, 0x142F, 0x1431, 0x1434, 0x1436, 0x1438, 0x143B, 0x143D, 0x143F, 0x1442, 0x1444, 0x1447, 0x1449, 0x144B,         
        0x144E, 0x1450, 0x1452, 0x1455, 0x1457, 0x1459, 0x145C, 0x145E, 0x1460, 0x1463, 0x1465, 0x1467, 0x146A, 0x146C, 0x146E, 0x1471,         
        0x1473, 0x1476, 0x1478, 0x147A, 0x147D, 0x147F, 0x1481, 0x1484, 0x1486, 0x1489, 0x148B, 0x148D, 0x1490, 0x1492, 0x1494, 0x1497,         
        0x1499, 0x149C, 0x149E, 0x14A0, 0x14A3, 0x14A5, 0x14A7, 0x14AA, 0x14AC, 0x14AF, 0x14B1, 0x14B3, 0x14B6, 0x14B8, 0x14BB, 0x14BD,         
        0x14BF, 0x14C2, 0x14C4, 0x14C7, 0x14C9, 0x14CB, 0x14CE, 0x14D0, 0x14D3, 0x14D5, 0x14D7, 0x14DA, 0x14DC, 0x14DF, 0x14E1, 0x14E3,         
        0x14E6, 0x14E8, 0x14EB, 0x14ED, 0x14F0, 0x14F2, 0x14F4, 0x14F7, 0x14F9, 0x14FC, 0x14FE, 0x1500, 0x1503, 0x1505, 0x1508, 0x150A,         
        0x150D, 0x150F, 0x1511, 0x1514, 0x1516, 0x1519, 0x151B, 0x151E, 0x1520, 0x1523, 0x1525, 0x1527, 0x152A, 0x152C, 0x152F, 0x1531,         
        0x1534, 0x1536, 0x1539, 0x153B, 0x153D, 0x1540, 0x1542, 0x1545, 0x1547, 0x154A, 0x154C, 0x154F, 0x1551, 0x1554, 0x1556, 0x1559,         
    },
    {
        0x155B, 0x155D, 0x1560, 0x1562, 0x1565, 0x1567, 0x156A, 0x156C, 0x156F, 0x1571, 0x1574, 0x1576, 0x1579, 0x157B, 0x157E, 0x1580,         
        0x1583, 0x1585, 0x1588, 0x158A, 0x158D, 0x158F, 0x1592, 0x1594, 0x1597, 0x1599, 0x159C, 0x159E, 0x15A1, 0x15A3, 0x15A6, 0x15A8,         
        0x15AB, 0x15AD, 0x15B0, 0x15B2, 0x15B5, 0x15B7, 0x15BA, 0x15BC, 0x15BF, 0x15C1, 0x15C4, 0x15C6, 0x15C9, 0x15CB, 0x15CE, 0x15D0,         
        0x15D3, 0x15D5, 0x15D8, 0x15DA, 0x15DD, 0x15DF, 0x15E2, 0x15E4, 0x15E7, 0x15E9, 0x15EC, 0x15EF, 0x15F1, 0x15F4, 0x15F6, 0x15F9,         
        0x15FB, 0x15FE, 0x1600, 0x1603, 0x1605, 0x1608, 0x160A, 0x160D, 0x1610, 0x1612, 0x1615, 0x1617, 0x161A, 0x161C, 0x161F, 0x1621,         
        0x1624, 0x1627, 0x1629, 0x162C, 0x162E, 0x1631, 0x1633, 0x1636, 0x1638, 0x163B, 0x163E, 0x1640, 0x1643, 0x1645, 0x1648, 0x164A,         
        0x164D, 0x1650, 0x1652, 0x1655, 0x1657, 0x165A, 0x165D, 0x165F, 0x1662, 0x1664, 0x1667, 0x1669, 0x166C, 0x166F, 0x1671, 0x1674,         
        0x1676, 0x1679, 0x167C, 0x167E, 0x1681, 0x1683, 0x1686, 0x1689, 0x168B, 0x168E, 0x1690, 0x1693, 0x1696, 0x1698, 0x169B, 0x169E,         
    },
    {
        0x16A0, 0x16A3, 0x16A5, 0x16A8, 0x16AB, 0x16AD, 0x16B0, 0x16B2, 0x16B5, 0x16B8, 0x16BA, 0x16BD, 0x16C0, 0x16C2, 0x16C5, 0x16C7,         
        0x16CA, 0x16CD, 0x16CF, 0x16D2, 0x16D5, 0x16D7, 0x16DA, 0x16DD, 0x16DF, 0x16E2, 0x16E4, 0x16E7, 0x16EA, 0x16EC, 0x16EF, 0x16F2,         
        0x16F4, 0x16F7, 0x16FA, 0x16FC, 0x16FF, 0x1702, 0x1704, 0x1707, 0x170A, 0x170C, 0x170F, 0x1712, 0x1714, 0x1717, 0x171A, 0x171C,         
        0x171F, 0x1722, 0x1724, 0x1727, 0x172A, 0x172C, 0x172F, 0x1732, 0x1734, 0x1737, 0x173A, 0x173C, 0x173F, 0x1742, 0x1744, 0x1747,         
        0x174A, 0x174D, 0x174F, 0x1752, 0x1755, 0x1757, 0x175A, 0x175D, 0x175F, 0x1762, 0x1765, 0x1768, 0x176A, 0x176D, 0x1770, 0x1772,         
        0x1775, 0x1778, 0x177A, 0x177D, 0x1780, 0x1783, 0x1785, 0x1788, 0x178B, 0x178E, 0x1790, 0x1793, 0x1796, 0x1798, 0x179B, 0x179E,         
        0x17A1, 0x17A3, 0x17A6, 0x17A9, 0x17AC, 0x17AE, 0x17B1, 0x17B4, 0x17B6, 0x17B9, 0x17BC, 0x17BF, 0x17C1, 0x17C4, 0x17C7, 0x17CA,         
        0x17CC, 0x17CF, 0x17D2, 0x17D5, 0x17D7, 0x17DA, 0x17DD, 0x17E0, 0x17E2, 0x17E5, 0x17E8, 0x17EB, 0x17ED, 0x17F0, 0x17F3, 0x17F6,         
    },
    {
        0x17F9, 0x17FB, 0x17FE, 0x1801, 0x1804, 0x1806, 0x1809, 0x180C, 0x180F, 0x1812, 0x1814, 0x1817, 0x181A, 0x181D, 0x181F, 0x1822,         
        0x1825, 0x1828, 0x182B, 0x182D, 0x1830, 0x1833, 0x1836, 0x1839, 0x183B, 0x183E, 0x1841, 0x1844, 0x1847, 0x1849, 0x184C, 0x184F,         
        0x1852, 0x1855, 0x1857, 0x185A, 0x185D, 0x1860, 0x1863, 0x1866, 0x1868, 0x186B, 0x186E, 0x1871, 0x1874, 0x1876, 0x1879, 0x187C,         
        0x187F, 0x1882, 0x1885, 0x1887, 0x188A, 0x188D, 0x1890, 0x1893, 0x1896, 0x1898, 0x189B, 0x189E, 0x18A1, 0x18A4, 0x18A7, 0x18AA,         
        0x18AC, 0x18AF, 0x18B2, 0x18B5, 0x18B8, 0x18BB, 0x18BE, 0x18C0, 0x18C3, 0x18C6, 0x18C9, 0x18CC, 0x18CF, 0x18D2, 0x18D4, 0x18D7,         
        0x18DA, 0x18DD, 0x18E0, 0x18E3, 0x18E6, 0x18E9, 0x18EB, 0x18EE, 0x18F1, 0x18F4, 0x18F7, 0x18FA, 0x18FD, 0x1900, 0x1902, 0x1905,         
        0x1908, 0x190B, 0x190E, 0x1911, 0x1914, 0x1917, 0x191A, 0x191D, 0x191F, 0x1922, 0x1925, 0x1928, 0x192B, 0x192E, 0x1931, 0x1934,         
        0x1937, 0x193A, 0x193D, 0x193F, 0x1942, 0x1945, 0x1948, 0x194B, 0x194E, 0x1951, 0x1954, 0x1957, 0x195A, 0x195D, 0x1960, 0x1963,         
    },
    {
        0x1965, 0x1968, 0x196B, 0x196E, 0x1971, 0x1974, 0x1977, 0x197A, 0x197D, 0x1980, 0x1983, 0x1986, 0x1989, 0x198C, 0x198F, 0x1992,         
        0x1995, 0x1998, 0x199B, 0x199D, 0x19A0, 0x19A3, 0x19A6, 0x19A9, 0x19AC, 0x19AF, 0x19B2, 0x19B5, 0x19B8, 0x19BB, 0x19BE, 0x19C1,         
        0x19C4, 0x19C7, 0x19CA, 0x19CD, 0x19D0, 0x19D3, 0x19D6, 0x19D9, 0x19DC, 0x19DF, 0x19E2, 0x19E5, 0x19E8, 0x19EB, 0x19EE, 0x19F1,         
        0x19F4, 0x19F7, 0x19FA, 0x19FD, 0x1A00, 0x1A03, 0x1A06, 0x1A09, 0x1A0C, 0x1A0F, 0x1A12, 0x1A15, 0x1A18, 0x1A1B, 0x1A1E, 0x1A21,         
        0x1A24, 0x1A27, 0x1A2A, 0x1A2D, 0x1A30, 0x1A33, 0x1A36, 0x1A39, 0x1A3C, 0x1A3F, 0x1A42, 0x1A45, 0x1A48, 0x1A4B, 0x1A4E, 0x1A51,         
        0x1A55, 0x1A58, 0x1A5B, 0x1A5E, 0x1A61, 0x1A64, 0x1A67, 0x1A6A, 0x1A6D, 0x1A70, 0x1A73, 0x1A76, 0x1A79, 0x1A7C, 0x1A7F, 0x1A82,         
        0x1A85, 0x1A88, 0x1A8B, 0x1A8F, 0x1A92, 0x1A95, 0x1A98, 0x1A9B, 0x1A9E, 0x1AA1, 0x1AA4, 0x1AA7, 0x1AAA, 0x1AAD, 0x1AB0, 0x1AB3,         
        0x1AB7, 0x1ABA, 0x1ABD, 0x1AC0, 0x1AC3, 0x1AC6, 0x1AC9, 0x1ACC, 0x1ACF, 0x1AD2, 0x1AD5, 0x1AD9, 0x1ADC, 0x1ADF, 0x1AE2, 0x1AE5,         
    },
    {
        0x1AE8, 0x1AEB, 0x1AEE, 0x1AF1, 0x1AF5, 0x1AF8, 0x1AFB, 0x1AFE, 0x1B01, 0x1B04, 0x1B07, 0x1B0A, 0x1B0E, 0x1B11, 0x1B14, 0x1B17,         
        0x1B1A, 0x1B1D, 0x1B20, 0x1B23, 0x1B27, 0x1B2A, 0x1B2D, 0x1B30, 0x1B33, 0x1B36, 0x1B39, 0x1B3D, 0x1B40, 0x1B43, 0x1B46, 0x1B49,         
        0x1B4C, 0x1B4F, 0x1B53, 0x1B56, 0x1B59, 0x1B5C, 0x1B5F, 0x1B62, 0x1B66, 0x1B69, 0x1B6C, 0x1B6F, 0x1B72, 0x1B75, 0x1B79, 0x1B7C,         
        0x1B7F, 0x1B82, 0x1B85, 0x1B89, 0x1B8C, 0x1B8F, 0x1B92, 0x1B95, 0x1B98, 0x1B9C, 0x1B9F, 0x1BA2, 0x1BA5, 0x1BA8, 0x1BAC, 0x1BAF,         
        0x1BB2, 0x1BB5, 0x1BB8, 0x1BBC, 0x1BBF, 0x1BC2, 0x1BC5, 0x1BC8, 0x1BCC, 0x1BCF, 0x1BD2, 0x1BD5, 0x1BD8, 0x1BDC, 0x1BDF, 0x1BE2,         
        0x1BE5, 0x1BE9, 0x1BEC, 0x1BEF, 0x1BF2, 0x1BF5, 0x1BF9, 0x1BFC, 0x1BFF, 0x1C02, 0x1C06, 0x1C09, 0x1C0C, 0x1C0F, 0x1C13, 0x1C16,         
        0x1C19, 0x1C1C, 0x1C20, 0x1C23, 0x1C26, 0x1C29, 0x1C2D, 0x1C30, 0x1C33, 0x1C36, 0x1C3A, 0x1C3D, 0x1C40, 0x1C43, 0x1C47, 0x1C4A,         
        0x1C4D, 0x1C51, 0x1C54, 0x1C57, 0x1C5A, 0x1C5E, 0x1C61, 0x1C64, 0x1C67, 0x1C6B, 0x1C6E, 0x1C71, 0x1C75, 0x1C78, 0x1C7B, 0x1C7E,         
    },
    {
        0x1C82, 0x1C85, 0x1C88, 0x1C8C, 0x1C8F, 0x1C92, 0x1C96, 0x1C99, 0x1C9C, 0x1C9F, 0x1CA3, 0x1CA6, 0x1CA9, 0x1CAD, 0x1CB0, 0x1CB3,         
        0x1CB7, 0x1CBA, 0x1CBD, 0x1CC1, 0x1CC4, 0x1CC7, 0x1CCB, 0x1CCE, 0x1CD1, 0x1CD5, 0x1CD8, 0x1CDB, 0x1CDF, 0x1CE2, 0x1CE5, 0x1CE9,         
        0x1CEC, 0x1CEF, 0x1CF3, 0x1CF6, 0x1CF9, 0x1CFD, 0x1D00, 0x1D03, 0x1D07, 0x1D0A, 0x1D0D, 0x1D11, 0x1D14, 0x1D17, 0x1D1B, 0x1D1E,         
        0x1D22, 0x1D25, 0x1D28, 0x1D2C, 0x1D2F, 0x1D32, 0x1D36, 0x1D39, 0x1D3D, 0x1D40, 0x1D43, 0x1D47, 0x1D4A, 0x1D4D, 0x1D51, 0x1D54,         
        0x1D58, 0x1D5B, 0x1D5E, 0x1D62, 0x1D65, 0x1D69, 0x1D6C, 0x1D6F, 0x1D73, 0x1D76, 0x1D7A, 0x1D7D, 0x1D80, 0x1D84, 0x1D87, 0x1D8B,         
        0x1D8E, 0x1D91, 0x1D95, 0x1D98, 0x1D9C, 0x1D9F, 0x1DA3, 0x1DA6, 0x1DA9, 0x1DAD, 0x1DB0, 0x1DB4, 0x1DB7, 0x1DBB, 0x1DBE, 0x1DC1,         
        0x1DC5, 0x1DC8, 0x1DCC, 0x1DCF, 0x1DD3, 0x1DD6, 0x1DDA, 0x1DDD, 0x1DE0, 0x1DE4, 0x1DE7, 0x1DEB, 0x1DEE, 0x1DF2, 0x1DF5, 0x1DF9,         
        0x1DFC, 0x1E00, 0x1E03, 0x1E06, 0x1E0A, 0x1E0D, 0x1E11, 0x1E14, 0x1E18, 0x1E1B, 0x1E1F, 0x1E22, 0x1E26, 0x1E29, 0x1E2D, 0x1E30,         
    },
    {
        0x1E34, 0x1E37, 0x1E3B, 0x1E3E, 0x1E42, 0x1E45, 0x1E49, 0x1E4C, 0x1E50, 0x1E53, 0x1E57, 0x1E5A, 0x1E5E, 0x1E61, 0x1E65, 0x1E68,         
        0x1E6C, 0x1E6F, 0x1E73, 0x1E76, 0x1E7A, 0x1E7D, 0x1E81, 0x1E84, 0x1E88, 0x1E8B, 0x1E8F, 0x1E93, 0x1E96, 0x1E9A, 0x1E9D, 0x1EA1,         
        0x1EA4, 0x1EA8, 0x1EAB, 0x1EAF, 0x1EB2, 0x1EB6, 0x1EB9, 0x1EBD, 0x1EC1, 0x1EC4, 0x1EC8, 0x1ECB, 0x1ECF, 0x1ED2, 0x1ED6, 0x1ED9,         
        0x1EDD, 0x1EE1, 0x1EE4, 0x1EE8, 0x1EEB, 0x1EEF, 0x1EF2, 0x1EF6, 0x1EFA, 0x1EFD, 0x1F01, 0x1F04, 0x1F08, 0x1F0C, 0x1F0F, 0x1F13,         
        0x1F16, 0x1F1A, 0x1F1D, 0x1F21, 0x1F25, 0x1F28, 0x1F2C, 0x1F2F, 0x1F33, 0x1F37, 0x1F3A, 0x1F3E, 0x1F42, 0x1F45, 0x1F49, 0x1F4C,         
        0x1F50, 0x1F54, 0x1F57, 0x1F5B, 0x1F5E, 0x1F62, 0x1F66, 0x1F69, 0x1F6D, 0x1F71, 0x1F74, 0x1F78, 0x1F7B, 0x1F7F, 0x1F83, 0x1F86,         
        0x1F8A, 0x1F8E, 0x1F91, 0x1F95, 0x1F99, 0x1F9C, 0x1FA0, 0x1FA4, 0x1FA7, 0x1FAB, 0x1FAF, 0x1FB2, 0x1FB6, 0x1FBA, 0x1FBD, 0x1FC1,         
        0x1FC5, 0x1FC8, 0x1FCC, 0x1FD0, 0x1FD3, 0x1FD7, 0x1FDB, 0x1FDE, 0x1FE2, 0x1FE6, 0x1FE9, 0x1FED, 0x1FF1, 0x1FF4, 0x1FF8, 0x1FFC,         
    },
};


extern s32 sd_timer_flag; // Only used in this file

s32 smf_timer() // 0x800A6D18
{
    if (sd_interrupt_start_flag == 0 || sd_int_flag != 0)
    {
        return 1;
    }

    if (sd_int_flag2 == 0)
    {
        sd_int_flag2 = 1;
        midi_smf_main();

        if (sd_timer_sync >= 11)
        {
            midi_vsync();
            SdAutoKeyOffCheck();
            sd_timer_sync = 0;
        }

        sd_int_flag2 = 0;
        sd_timer_sync++;
    }

    return 0;
}

void smf_timer_set() // 0x800A6DC0
{
    if (sd_timer_flag == 0)
    {
        sd_timer_flag = 1;

        EnterCriticalSection();
        sd_timer_event = OpenEvent(RCntCNT2, EvSpINT, EvMdINTR, smf_timer);
        EnableEvent(sd_timer_event);
        SetRCnt(RCntCNT2, 7328, RCntMdINTR); // ~30Hz?
        StartRCnt(RCntCNT2);
        ExitCriticalSection();

        sd_int_flag   = 0;
        sd_timer_flag = 0;
    }
}

void smf_timer_end() // 0x800A6E58
{
    sd_timer_flag = 1;

    EnterCriticalSection();
    StopRCnt(RCntCNT2);
    DisableEvent(sd_timer_event);
    CloseEvent(sd_timer_event);
    ExitCriticalSection();

    sd_timer_flag = 0;
    sd_int_flag   = 0;
}

void smf_timer_stop() // 0x800A6EC8
{
    sd_timer_flag = 1;

    EnterCriticalSection();
    StopRCnt(RCntCNT2);
    ExitCriticalSection();

    sd_timer_flag = 0;
    sd_int_flag   = 0;
}

void smf_vsync() // 0x800A6F14
{
    if (sd_int_flag2 != 0)
        return;

    sd_int_flag2 = 1;

    if (smf_start_flag != 0)
    {
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
        midi_smf_main();
    }

    midi_vsync();
    SdAutoKeyOffCheck();
    sd_int_flag2 = 0;
}
